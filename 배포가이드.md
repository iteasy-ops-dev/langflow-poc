# ğŸš€ ITEASY AI í”Œë«í¼ - í”„ë¡œë•ì…˜ ë°°í¬ ê°€ì´ë“œ

**ì„œë²„ IP**: 222.234.220.231

---

## ğŸ“‹ ì‚¬ì „ ìš”êµ¬ì‚¬í•­

### ì„œë²„ í™˜ê²½
- **OS**: Ubuntu 20.04 LTS ì´ìƒ / CentOS 8 ì´ìƒ
- **CPU**: ìµœì†Œ 4 Core (ê¶Œì¥ 8 Core)
- **RAM**: ìµœì†Œ 8GB (ê¶Œì¥ 16GB)
- **Disk**: ìµœì†Œ 50GB ì—¬ìœ  ê³µê°„
- **ë„¤íŠ¸ì›Œí¬**: ê³µì¸ IP í• ë‹¹ (222.234.220.231)

### ì„¤ì¹˜ í•„ìš” ì†Œí”„íŠ¸ì›¨ì–´
```bash
# Docker
sudo apt update
sudo apt install -y docker.io

# Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker compose
sudo chmod +x /usr/local/bin/docker compose

# í™•ì¸
docker --version
docker compose --version
```

---

## ğŸ“¦ 1ë‹¨ê³„: í”„ë¡œì íŠ¸ ì—…ë¡œë“œ

### ë°©ë²• 1: Git ì‚¬ìš© (ê¶Œì¥)
```bash
cd /opt
sudo git clone <repository-url> iteasy-platform
cd iteasy-platform
```

### ë°©ë²• 2: íŒŒì¼ ì••ì¶• ì „ì†¡
```bash
# ë¡œì»¬ì—ì„œ ì••ì¶•
cd /Users/banhun/banhun28/extendLangFlow
tar -czf iteasy-platform.tar.gz \
  docker-compose.prod.yml \
  .env.prod \
  deploy.sh \
  frontend/ \
  nginx/ \
  monitoring/ \
  --exclude='frontend/node_modules' \
  --exclude='frontend/.next'

# ì„œë²„ë¡œ ì „ì†¡
scp iteasy-platform.tar.gz user@222.234.220.231:/opt/

# ì„œë²„ì—ì„œ ì••ì¶• í•´ì œ
ssh user@222.234.220.231
cd /opt
sudo tar -xzf iteasy-platform.tar.gz
sudo mv extendLangFlow iteasy-platform
cd iteasy-platform
```

---

## ğŸ” 2ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
cd /opt/iteasy-platform

# .env.prod íŒŒì¼ ìˆ˜ì •
sudo nano .env.prod
```

**í•„ìˆ˜ ë³€ê²½ ì‚¬í•­**:
```bash
# PostgreSQL - ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½
POSTGRES_PASSWORD=YOUR_STRONG_PASSWORD_HERE

# Langflow - ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
LANGFLOW_PASSWORD=YOUR_LANGFLOW_PASSWORD_HERE

# Grafana - ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
GRAFANA_PASSWORD=YOUR_GRAFANA_PASSWORD_HERE

# Nginx - Basic Auth ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
NGINX_PASSWORD=YOUR_NGINX_PASSWORD_HERE
```

**ë¹„ë°€ë²ˆí˜¸ ê¶Œì¥ ì‚¬í•­**:
- ìµœì†Œ 16ì ì´ìƒ
- ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì ì¡°í•©
- ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ ë‹¤ë¥¸ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©

---

## ğŸ”¥ 3ë‹¨ê³„: ë°©í™”ë²½ ì„¤ì •

```bash
# UFW ì‚¬ìš© ì‹œ
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw reload

# firewalld ì‚¬ìš© ì‹œ
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --reload

# í™•ì¸
sudo ufw status
# ë˜ëŠ”
sudo firewall-cmd --list-all
```

**ì£¼ì˜**: ë‚´ë¶€ í¬íŠ¸(3000, 7860, 9090 ë“±)ëŠ” ì—´ì§€ ë§ˆì„¸ìš”. Nginxë¡œë§Œ ì ‘ê·¼í•©ë‹ˆë‹¤.

---

## ğŸš€ 4ë‹¨ê³„: ë°°í¬ ì‹¤í–‰

```bash
cd /opt/iteasy-platform

# ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
sudo ./deploy.sh
```

ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ìœ¼ë¡œ:
1. âœ… í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
2. âœ… Docker ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
3. âœ… Frontend ë¹Œë“œ
4. âœ… Nginx ì¸ì¦ íŒŒì¼ ìƒì„±
5. âœ… ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
6. âœ… ìƒíƒœ í™•ì¸

---

## ğŸ” 5ë‹¨ê³„: ë°°í¬ í™•ì¸

### ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ
sudo docker compose -f docker-compose.prod.yml ps

# ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ "Up" ìƒíƒœì—¬ì•¼ í•¨
```

### Health Check
```bash
curl http://222.234.220.231/health
# ì¶œë ¥: healthy
```

### ê° ì„œë¹„ìŠ¤ ì ‘ì† í…ŒìŠ¤íŠ¸
```bash
# Frontend
curl -I http://222.234.220.231/

# Langflow
curl -I http://222.234.220.231/langflow/

# Grafana
curl -I http://222.234.220.231/grafana/
```

---

## ğŸŒ 6ë‹¨ê³„: ì ‘ì† ë° ì„¤ì •

### ğŸ“± Frontend (ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜)
- **URL**: http://222.234.220.231
- **í˜ì´ì§€**:
  - `/` - í™ˆ
  - `/chatbot` - AI ì±—ë´‡
  - `/summarize` - ë¬¸ì„œ ìš”ì•½
  - `/log-analysis` - ë¡œê·¸ ë¶„ì„
  - `/settings` - ì„¤ì •

### ğŸ¤– Langflow (AI ì›Œí¬í”Œë¡œìš°)
- **URL**: http://222.234.220.231/langflow
- **ê³„ì •**: admin / [.env.prodì˜ LANGFLOW_PASSWORD]
- **ì‘ì—…**:
  1. ë¡œê·¸ì¸
  2. 3ê°œ ì›Œí¬í”Œë¡œìš° ìƒì„± (chatbot, summarize, log-analysis)
  3. Flow IDì™€ API Key ë³µì‚¬
  4. Frontend `/settings`ì—ì„œ ì„¤ì •

### ğŸ“Š Grafana (ëª¨ë‹ˆí„°ë§)
- **URL**: http://222.234.220.231/grafana
- **ê³„ì •**: admin / [.env.prodì˜ GRAFANA_PASSWORD]
- **ëŒ€ì‹œë³´ë“œ**:
  - "ITEASY AI í”Œë«í¼ ëª¨ë‹ˆí„°ë§" (í•œê¸€)
  - "ITEASY AI Platform - Container Monitoring" (ì˜ë¬¸)

### ğŸ“ˆ Prometheus (ë©”íŠ¸ë¦­)
- **URL**: http://222.234.220.231/prometheus
- **ê³„ì •**: admin / [.env.prodì˜ NGINX_PASSWORD]
- **ìš©ë„**: Grafanaì—ì„œ ë°ì´í„° ì†ŒìŠ¤ë¡œ ì‚¬ìš©

---

## ğŸ“Š 7ë‹¨ê³„: ëª¨ë‹ˆí„°ë§ ì„¤ì •

### Grafana ëŒ€ì‹œë³´ë“œ ì„í¬íŠ¸

ëŒ€ì‹œë³´ë“œê°€ ìë™ìœ¼ë¡œ ë¡œë“œë˜ì§€ ì•Šìœ¼ë©´ ìˆ˜ë™ ì„í¬íŠ¸:

```bash
# ì„œë²„ì—ì„œ
cd /opt/iteasy-platform/monitoring

# í•œê¸€ ëŒ€ì‹œë³´ë“œ ì„í¬íŠ¸
curl -X POST \
  -H "Content-Type: application/json" \
  -u admin:YOUR_GRAFANA_PASSWORD \
  -d @grafana-dashboard-korean.json \
  http://localhost:3000/api/dashboards/db
```

ë˜ëŠ” Grafana UIì—ì„œ:
1. Dashboards â†’ Import
2. Upload JSON file
3. `monitoring/grafana-dashboard-korean.json` ì„ íƒ

---

## ğŸ› ï¸ ìš´ì˜ ê´€ë¦¬

### ë¡œê·¸ í™•ì¸
```bash
# ì „ì²´ ë¡œê·¸
sudo docker compose -f docker-compose.prod.yml logs

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
sudo docker compose -f docker-compose.prod.yml logs -f frontend
sudo docker compose -f docker-compose.prod.yml logs -f langflow
sudo docker compose -f docker-compose.prod.yml logs -f nginx

# ìµœê·¼ 100ì¤„ë§Œ
sudo docker compose -f docker-compose.prod.yml logs --tail=100
```

### ì„œë¹„ìŠ¤ ì¬ì‹œì‘
```bash
# ì „ì²´ ì¬ì‹œì‘
sudo docker compose -f docker-compose.prod.yml restart

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ
sudo docker compose -f docker-compose.prod.yml restart frontend
```

### ì„œë¹„ìŠ¤ ì¤‘ì§€
```bash
# ì¤‘ì§€ (ë°ì´í„° ë³´ì¡´)
sudo docker compose -f docker-compose.prod.yml stop

# ì™„ì „ ì‚­ì œ (ë°ì´í„° ì‚­ì œ)
sudo docker compose -f docker-compose.prod.yml down -v
```

### ì—…ë°ì´íŠ¸
```bash
cd /opt/iteasy-platform

# ì½”ë“œ ì—…ë°ì´íŠ¸ (Git ì‚¬ìš© ì‹œ)
sudo git pull

# ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
sudo docker compose -f docker-compose.prod.yml pull

# Frontend ì¬ë¹Œë“œ
sudo docker compose -f docker-compose.prod.yml build frontend

# ì¬ì‹œì‘
sudo docker compose -f docker-compose.prod.yml up -d
```

---

## ğŸ”’ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ì‚¬í•­
- [ ] `.env.prod`ì˜ ëª¨ë“  ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
- [ ] ë°©í™”ë²½ì—ì„œ ë¶ˆí•„ìš”í•œ í¬íŠ¸ ì°¨ë‹¨
- [ ] Nginx Basic Auth í™œì„±í™” (Prometheus)
- [ ] PostgreSQL ì™¸ë¶€ ì ‘ê·¼ ì°¨ë‹¨ (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë§Œ)
- [ ] ì •ê¸°ì ì¸ Docker ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸

### ê¶Œì¥ ì‚¬í•­
- [ ] SSL/TLS ì¸ì¦ì„œ ì„¤ì • (Let's Encrypt)
- [ ] ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì •
- [ ] ë°±ì—… ìë™í™” (DB, volumes)
- [ ] ëª¨ë‹ˆí„°ë§ ì•Œë¦¼ ì„¤ì •
- [ ] fail2ban ì„¤ì¹˜ (ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ë°©ì§€)

---

## ğŸ“¦ ë°±ì—…

### ë°ì´í„° ë°±ì—…
```bash
# ë³¼ë¥¨ ë°±ì—…
sudo docker run --rm \
  -v iteasy-platform_postgres-data:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/postgres-backup-$(date +%Y%m%d).tar.gz /data

sudo docker run --rm \
  -v iteasy-platform_langflow-data:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/langflow-backup-$(date +%Y%m%d).tar.gz /data
```

### ë³µì›
```bash
# ë³¼ë¥¨ ë³µì›
sudo docker run --rm \
  -v iteasy-platform_postgres-data:/data \
  -v $(pwd):/backup \
  alpine sh -c "cd / && tar xzf /backup/postgres-backup-YYYYMMDD.tar.gz"
```

---

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ
```bash
# ë¡œê·¸ í™•ì¸
sudo docker compose -f docker-compose.prod.yml logs [service-name]

# ì¼ë°˜ì  ì›ì¸:
# 1. ë©”ëª¨ë¦¬ ë¶€ì¡± â†’ ì„œë²„ ë¦¬ì†ŒìŠ¤ í™•ì¸
# 2. í¬íŠ¸ ì¶©ëŒ â†’ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ì¤‘ì§€
# 3. ê¶Œí•œ ë¬¸ì œ â†’ sudo ì‚¬ìš©
```

### ë¬¸ì œ 2: Frontend ì ‘ì† ì•ˆë¨
```bash
# Nginx ì„¤ì • í™•ì¸
sudo docker exec iteasy-nginx nginx -t

# Frontend ë¡œê·¸
sudo docker compose -f docker-compose.prod.yml logs frontend

# ë„¤íŠ¸ì›Œí¬ í™•ì¸
sudo docker network inspect iteasy-platform_iteasy-network
```

### ë¬¸ì œ 3: Grafana ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì—†ìŒ
```bash
# Prometheus íƒ€ê²Ÿ í™•ì¸
curl http://localhost:9090/api/v1/targets

# cAdvisor ë©”íŠ¸ë¦­ í™•ì¸
curl http://localhost:8080/metrics | grep container_memory

# ë°ì´í„°ì†ŒìŠ¤ ì¬ì—°ê²°
# Grafana UI â†’ Configuration â†’ Data Sources â†’ Prometheus â†’ Test
```

### ë¬¸ì œ 4: ë©”ëª¨ë¦¬ ë¶€ì¡±
```bash
# ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ í™•ì¸
sudo docker stats

# ë¶ˆí•„ìš”í•œ ì»¨í…Œì´ë„ˆ ì œê±°
sudo docker system prune -a

# Swap ì„¤ì • (Ubuntu)
sudo fallocate -l 4G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

---

## ğŸ“Š ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ (ì˜ˆìƒ)

| ì„œë¹„ìŠ¤ | CPU | ë©”ëª¨ë¦¬ | ë””ìŠ¤í¬ |
|--------|-----|--------|--------|
| Frontend | 0.5 Core | 512 MB | 500 MB |
| Langflow | 1-2 Core | 1-2 GB | 2 GB |
| PostgreSQL | 0.5 Core | 256 MB | 5 GB |
| Nginx | 0.1 Core | 50 MB | 100 MB |
| Prometheus | 0.2 Core | 200 MB | 1 GB |
| Grafana | 0.2 Core | 200 MB | 500 MB |
| cAdvisor | 0.1 Core | 100 MB | 50 MB |
| **ì´í•©** | **3-4 Core** | **3-4 GB** | **10 GB** |

---

## ğŸ¯ ì„±ëŠ¥ ìµœì í™”

### Nginx ìºì‹± ì¶”ê°€
```nginx
# nginx/conf.d/default.confì— ì¶”ê°€
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m max_size=1g;
```

### PostgreSQL íŠœë‹
```bash
# docker-compose.prod.ymlì˜ postgres ì„¹ì…˜ì— ì¶”ê°€
command: postgres -c shared_buffers=256MB -c max_connections=100
```

### Prometheus ë°ì´í„° ë³´ê´€ ê¸°ê°„ ì¡°ì •
```bash
# ì´ë¯¸ ì„¤ì •ë¨: --storage.tsdb.retention.time=30d
# í•„ìš” ì‹œ 15dë¡œ ì¤„ì—¬ì„œ ë””ìŠ¤í¬ ì ˆì•½
```

---

## ğŸ“ ì§€ì›

**ë¬¸ì œ ë°œìƒ ì‹œ**:
1. ë¡œê·¸ ìˆ˜ì§‘: `sudo docker compose -f docker-compose.prod.yml logs > error.log`
2. ì‹œìŠ¤í…œ ì •ë³´: `docker info`, `free -h`, `df -h`
3. ë„¤íŠ¸ì›Œí¬ ìƒíƒœ: `netstat -tulpn | grep -E "80|443|3000|7860"`

---

**ë°°í¬ ì™„ë£Œ!** ğŸ‰

ì´ì œ http://222.234.220.231 ë¡œ ì ‘ì†í•˜ì—¬ ITEASY AI í”Œë«í¼ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
