# ✅ 배포 체크리스트

**서버**: 222.234.220.231  
**날짜**: ____________

---

## 📋 배포 전 준비

### 서버 환경
- [ ] Docker 설치 완료 (`docker --version`)
- [ ] Docker Compose 설치 완료 (`docker compose --version`)
- [ ] 최소 8GB RAM 확인 (`free -h`)
- [ ] 최소 50GB 디스크 여유 공간 (`df -h`)
- [ ] 공인 IP 222.234.220.231 할당 확인

### 파일 업로드
- [ ] 프로젝트 파일 서버 업로드 완료 (`/opt/iteasy-platform`)
- [ ] 모든 디렉토리 존재 확인 (`frontend/`, `nginx/`, `monitoring/`)
- [ ] 파일 권한 확인 (`deploy.sh` 실행 권한)

### 보안 설정
- [ ] `.env.prod` 파일 생성
- [ ] `POSTGRES_PASSWORD` 변경 (기본값 아님)
- [ ] `LANGFLOW_PASSWORD` 변경 (기본값 아님)
- [ ] `GRAFANA_PASSWORD` 변경 (기본값 아님)
- [ ] `NGINX_PASSWORD` 변경 (기본값 아님)
- [ ] 비밀번호 16자 이상, 복잡도 확인

### 네트워크 설정
- [ ] 방화벽 80 포트 오픈
- [ ] 방화벽 443 포트 오픈 (HTTPS 사용 시)
- [ ] 불필요한 포트 차단 (3000, 5432, 7860, 9090 등)

---

## 🚀 배포 실행

### 1단계: 배포 스크립트 실행
```bash
cd /opt/iteasy-platform
sudo ./deploy.sh
```

- [ ] 스크립트 실행 성공
- [ ] 환경 변수 검증 통과
- [ ] Docker 이미지 다운로드 완료
- [ ] Frontend 빌드 성공
- [ ] Nginx 인증 파일 생성
- [ ] 모든 컨테이너 시작

### 2단계: 컨테이너 상태 확인
```bash
sudo docker compose -f docker-compose.prod.yml ps
```

**모든 컨테이너 "Up" 상태 확인**:
- [ ] iteasy-frontend
- [ ] iteasy-langflow
- [ ] iteasy-postgres
- [ ] iteasy-nginx
- [ ] iteasy-prometheus
- [ ] iteasy-grafana
- [ ] iteasy-cadvisor

### 3단계: Health Check
```bash
curl http://222.234.220.231/health
```
- [ ] "healthy" 응답 확인

---

## 🔍 서비스 접속 테스트

### Frontend
```bash
curl -I http://222.234.220.231/
```
- [ ] HTTP 200 응답
- [ ] 브라우저에서 접속 가능
- [ ] `/chatbot` 페이지 로드
- [ ] `/summarize` 페이지 로드
- [ ] `/log-analysis` 페이지 로드
- [ ] `/settings` 페이지 로드

### Langflow
```bash
curl -I http://222.234.220.231/langflow/
```
- [ ] HTTP 200 응답
- [ ] 브라우저에서 로그인 가능
- [ ] 계정: admin / [설정한 비밀번호]
- [ ] 워크플로우 생성 가능

### Grafana
```bash
curl -I http://222.234.220.231/grafana/
```
- [ ] HTTP 200 응답
- [ ] 브라우저에서 로그인 가능
- [ ] 계정: admin / [설정한 비밀번호]
- [ ] Prometheus 데이터소스 연결됨
- [ ] 대시보드 표시됨

### Prometheus
```bash
curl -u admin:YOUR_PASSWORD -I http://222.234.220.231/prometheus/
```
- [ ] HTTP 200 응답 (인증 성공)
- [ ] Targets 2개 "up" 상태 (prometheus, cadvisor)

---

## 📊 모니터링 확인

### cAdvisor 메트릭
```bash
sudo docker exec iteasy-cadvisor wget -qO- http://localhost:8080/metrics | grep container_memory | head -5
```
- [ ] 컨테이너 메트릭 수집 중

### Prometheus 메트릭
```bash
curl -s 'http://localhost:9090/api/v1/query?query=up' | grep -o '"value":\[.*\]'
```
- [ ] 메트릭 데이터 존재

### Grafana 대시보드
- [ ] "ITEASY AI 플랫폼 모니터링" 대시보드 존재
- [ ] 7개 컨테이너 메모리 데이터 표시
- [ ] CPU 게이지 작동
- [ ] 네트워크 그래프 표시

---

## 🔧 Langflow 설정

### 워크플로우 생성
- [ ] **Chatbot Flow** 생성
  - Flow ID: ________________
  - API Key: ________________

- [ ] **Summarization Flow** 생성
  - Flow ID: ________________
  - API Key: ________________

- [ ] **Log Analysis Flow** 생성
  - Flow ID: ________________
  - API Key: ________________

### Frontend 연동
- [ ] Frontend `/settings` 접속
- [ ] Chatbot Flow ID 입력 및 저장
- [ ] Summarization Flow ID 입력 및 저장
- [ ] Log Analysis Flow ID 입력 및 저장
- [ ] API Key 입력 및 저장

---

## 🧪 기능 테스트

### AI Chatbot (`/chatbot`)
- [ ] 메시지 입력 가능
- [ ] AI 응답 수신
- [ ] Markdown 렌더링 작동
- [ ] 대화 히스토리 유지

### Document Summarization (`/summarize`)
- [ ] PDF 파일 업로드 가능
- [ ] 파일 파싱 성공
- [ ] AI 요약 생성
- [ ] 결과 표시

### Log Analysis (`/log-analysis`)
- [ ] JSON 파일 업로드 테스트
- [ ] CSV 파일 업로드 테스트
- [ ] 파일 형식 자동 감지
- [ ] AI 분석 결과 표시

---

## 📈 성능 확인

### 리소스 사용량
```bash
sudo docker stats --no-stream
```

**기대값**:
- [ ] Langflow: ~1-2GB 메모리
- [ ] Frontend: ~500MB 메모리
- [ ] PostgreSQL: ~100MB 메모리
- [ ] 전체 CPU: ~30% 이하 (유휴 시)

### 응답 시간
```bash
curl -w "\nTime: %{time_total}s\n" -o /dev/null -s http://222.234.220.231/
```
- [ ] Frontend 응답 시간 < 2초
- [ ] Langflow 응답 시간 < 3초

---

## 🔒 보안 최종 확인

### 외부 접근 차단
```bash
nmap -p 1-10000 222.234.220.231
```

**열려 있어야 할 포트**:
- [ ] 80 (HTTP)
- [ ] 443 (HTTPS, 설정 시)

**닫혀 있어야 할 포트**:
- [ ] 3000 (Frontend 내부)
- [ ] 5432 (PostgreSQL)
- [ ] 7860 (Langflow 내부)
- [ ] 9090 (Prometheus 내부)
- [ ] 8080 (cAdvisor 내부)

### 비밀번호 강도
- [ ] 모든 서비스 기본 비밀번호 변경됨
- [ ] `.env.prod` 파일 권한 600 (`chmod 600 .env.prod`)
- [ ] Prometheus Basic Auth 작동

---

## 📝 문서화

### 운영 문서
- [ ] `.env.prod` 백업 (안전한 곳에 보관)
- [ ] 비밀번호 관리 시스템에 등록
- [ ] 접속 정보 공유 (팀원)
- [ ] 장애 대응 매뉴얼 숙지

### 백업 설정
- [ ] 데이터베이스 백업 스크립트 작성
- [ ] Cron 작업 등록 (일일 백업)
- [ ] 백업 파일 저장 위치 확인
- [ ] 복원 테스트 1회 수행

---

## ✅ 배포 완료 확인

### 최종 체크
- [ ] 모든 서비스 정상 작동
- [ ] 모니터링 대시보드 작동
- [ ] 3개 use case 테스트 완료
- [ ] 로그 확인 (에러 없음)
- [ ] 문서 정리 완료

### 다음 단계
- [ ] 사용자 교육 자료 준비
- [ ] 운영 팀에 인계
- [ ] 모니터링 알림 설정
- [ ] SSL 인증서 적용 (선택)
- [ ] 백업 자동화 (선택)

---

## 📞 연락처

**배포 담당자**: ________________  
**배포 일시**: ________________  
**승인자**: ________________

---

**모든 항목 체크 완료 시 배포 성공! 🎉**
