# ğŸ”¤ í•œê¸€ ì¸ì½”ë”© ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

## ğŸ“‹ ë¬¸ì œ ìƒí™©

**ì¦ìƒ**: íŒŒì¼ ì—…ë¡œë“œ ì‹œ í•œê¸€ì´ ê¹¨ì ¸ì„œ í‘œì‹œë¨  
**ì›ì¸**: FileReaderê°€ ì¸ì½”ë”©ì„ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ ì‹œìŠ¤í…œ ê¸°ë³¸ ì¸ì½”ë”© ì‚¬ìš©

---

## âœ… ì ìš©ëœ í•´ê²° ë°©ë²•

### 1. **FileReader UTF-8 ëª…ì‹œ**

#### ìˆ˜ì • ì „ (ë¬¸ì œ ì½”ë“œ)
```typescript
const reader = new FileReader()
reader.onload = (event) => {
  const text = event.target?.result as string
  setDocumentText(text)
}
reader.readAsText(file)  // âŒ ì¸ì½”ë”© ë¯¸ì§€ì •
```

#### ìˆ˜ì • í›„ (í•´ê²° ì½”ë“œ)
```typescript
const reader = new FileReader()
reader.onload = (event) => {
  const text = event.target?.result as string
  setDocumentText(text)
}
reader.readAsText(file, 'UTF-8')  // âœ… UTF-8 ëª…ì‹œ
```

### 2. **file.text() ëŒ€ì‹  FileReader ì‚¬ìš©**

#### ìˆ˜ì • ì „
```typescript
// file.text()ëŠ” ì¸ì½”ë”© ì§€ì • ë¶ˆê°€
const text = await file.text()
const json = JSON.parse(text)
```

#### ìˆ˜ì • í›„
```typescript
const reader = new FileReader()
reader.onload = (event) => {
  const text = event.target?.result as string
  const json = JSON.parse(text)
  setLogText(JSON.stringify(json, null, 2))
}
reader.readAsText(file, 'UTF-8')
```

### 3. **PapaParse CSV ì¸ì½”ë”© ì„¤ì •**

```typescript
Papa.parse(text, {
  encoding: 'UTF-8',          // âœ… ì¸ì½”ë”© ëª…ì‹œ
  skipEmptyLines: true,       // ë¹ˆ ì¤„ ì œê±°
  complete: (results) => {
    // ì²˜ë¦¬ ë¡œì§
  }
})
```

---

## ğŸ” ì¸ì½”ë”© ê°ì§€ ìœ í‹¸ë¦¬í‹°

ë³µì¡í•œ ì¸ì½”ë”© í™˜ê²½ì„ ìœ„í•œ ìë™ ê°ì§€ ê¸°ëŠ¥:

```typescript
// frontend/lib/encoding.ts
export async function detectEncoding(file: File): Promise<string> {
  const arrayBuffer = await file.arrayBuffer()
  const bytes = new Uint8Array(arrayBuffer).slice(0, 100)
  
  // BOM ì²´í¬
  if (bytes[0] === 0xEF && bytes[1] === 0xBB && bytes[2] === 0xBF) {
    return 'UTF-8'
  }
  
  if (bytes[0] === 0xFE && bytes[1] === 0xFF) {
    return 'UTF-16BE'
  }
  
  if (bytes[0] === 0xFF && bytes[1] === 0xFE) {
    return 'UTF-16LE'
  }
  
  // ê¸°ë³¸ê°’
  return 'UTF-8'
}

export async function readFileWithEncoding(
  file: File, 
  encoding?: string
): Promise<string> {
  if (!encoding) {
    encoding = await detectEncoding(file)
  }
  
  return new Promise((resolve, reject) => {
    const reader = new FileReader()
    reader.onload = (event) => {
      resolve(event.target?.result as string)
    }
    reader.onerror = () => {
      reject(new Error('íŒŒì¼ ì½ê¸° ì‹¤íŒ¨'))
    }
    reader.readAsText(file, encoding)
  })
}
```

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

### 1. `frontend/app/summarize/page.tsx`
- âœ… TXT/MD íŒŒì¼ ì½ê¸° ì‹œ `UTF-8` ëª…ì‹œ

### 2. `frontend/app/log-analysis/page.tsx`
- âœ… JSON íŒŒì¼ ì½ê¸° ì‹œ `UTF-8` ëª…ì‹œ
- âœ… CSV íŒŒì¼ ì½ê¸° ì‹œ `UTF-8` ëª…ì‹œ
- âœ… ê¸°íƒ€ í…ìŠ¤íŠ¸ íŒŒì¼ ì½ê¸° ì‹œ `UTF-8` ëª…ì‹œ

### 3. `frontend/lib/encoding.ts` (ì‹ ê·œ)
- âœ… ì¸ì½”ë”© ìë™ ê°ì§€ í•¨ìˆ˜
- âœ… ì¸ì½”ë”© ì§€ì • íŒŒì¼ ì½ê¸° í•¨ìˆ˜

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. **í•œê¸€ í…ìŠ¤íŠ¸ íŒŒì¼ í…ŒìŠ¤íŠ¸**

```bash
# í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒì„±
echo "ì•ˆë…•í•˜ì„¸ìš” ITEASY AI í”Œë«í¼ì…ë‹ˆë‹¤." > test-korean.txt
```

1. Frontend `/summarize` ì ‘ì†
2. `test-korean.txt` ì—…ë¡œë“œ
3. í•œê¸€ì´ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

### 2. **í•œê¸€ JSON íŒŒì¼ í…ŒìŠ¤íŠ¸**

```json
{
  "ë©”ì‹œì§€": "ì•ˆë…•í•˜ì„¸ìš”",
  "ì‚¬ìš©ì": "í™ê¸¸ë™",
  "ë‚´ìš©": "í•œê¸€ ì¸ì½”ë”© í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤"
}
```

1. Frontend `/log-analysis` ì ‘ì†
2. JSON íŒŒì¼ ì—…ë¡œë“œ
3. í•œê¸€ì´ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

### 3. **í•œê¸€ CSV íŒŒì¼ í…ŒìŠ¤íŠ¸**

```csv
ì´ë¦„,ë‚˜ì´,ì§ì—…
í™ê¸¸ë™,30,ê°œë°œì
ê¹€ì² ìˆ˜,25,ë””ìì´ë„ˆ
ì´ì˜í¬,28,ê¸°íšì
```

1. Frontend `/log-analysis` ì ‘ì†
2. CSV íŒŒì¼ ì—…ë¡œë“œ
3. í•œê¸€ì´ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

---

## ğŸ”§ ì„œë²„ ì¸¡ ì²˜ë¦¬ (ì°¸ê³ )

Langflow APIë„ í•œê¸€ì„ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤:

```typescript
// frontend/app/api/langflow/route.ts
export async function POST(request: Request) {
  const body = await request.json()
  
  const response = await fetch(`${langflowUrl}/api/v1/run/${flowId}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json; charset=utf-8',  // âœ… charset ëª…ì‹œ
      'x-api-key': apiKey,
    },
    body: JSON.stringify({
      input_value: body.input_value,
      // ...
    }),
  })
  
  // ì‘ë‹µë„ UTF-8ë¡œ ì½ê¸°
  const data = await response.json()
  return Response.json(data)
}
```

---

## â“ ë¬¸ì œ í•´ê²° (Troubleshooting)

### Q1: ì—¬ì „íˆ í•œê¸€ì´ ê¹¨ì§‘ë‹ˆë‹¤

**A1**: íŒŒì¼ì´ UTF-8ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì¸ì½”ë”©ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# íŒŒì¼ ì¸ì½”ë”© í™•ì¸ (Mac/Linux)
file -I test.txt

# ì¸ì½”ë”© ë³€í™˜ (EUC-KR â†’ UTF-8)
iconv -f EUC-KR -t UTF-8 test.txt > test-utf8.txt
```

### Q2: PDF íŒŒì¼ í•œê¸€ì´ ê¹¨ì§‘ë‹ˆë‹¤

**A2**: PDFëŠ” `arrayBuffer`ë¡œ ì½ìœ¼ë¯€ë¡œ ì¸ì½”ë”© ë¬¸ì œê°€ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤. PDF ìì²´ì— í°íŠ¸ê°€ ì„ë² ë“œë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```typescript
// PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ ì‹œ í•œê¸€ ì²˜ë¦¬ í™•ì¸
const pageText = textContent.items
  .map((item: any) => item.str)
  .join(' ')  // ê³µë°±ìœ¼ë¡œ ì—°ê²°í•˜ì—¬ ë‹¨ì–´ ë¶„ë¦¬ ë³´ì¥
```

### Q3: ë¸Œë¼ìš°ì €ë§ˆë‹¤ ë‹¤ë¥´ê²Œ í‘œì‹œë©ë‹ˆë‹¤

**A3**: ëª¨ë“  ë¸Œë¼ìš°ì €ëŠ” UTF-8ì„ ì§€ì›í•˜ë¯€ë¡œ, FileReaderì— `UTF-8`ì„ ëª…ì‹œí•˜ë©´ ì¼ê´€ë˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.

---

## ğŸ“Š ì§€ì› ì¸ì½”ë”©

| ì¸ì½”ë”© | ì§€ì› ì—¬ë¶€ | ë¹„ê³  |
|--------|-----------|------|
| UTF-8 | âœ… | **ê¶Œì¥** - ê¸°ë³¸ ì¸ì½”ë”© |
| UTF-16LE | âœ… | Windows ë©”ëª¨ì¥ ìœ ë‹ˆì½”ë“œ |
| UTF-16BE | âœ… | Big Endian |
| EUC-KR | âš ï¸ | íŒŒì¼ì„ UTF-8ë¡œ ë³€í™˜ ê¶Œì¥ |
| CP949 | âš ï¸ | íŒŒì¼ì„ UTF-8ë¡œ ë³€í™˜ ê¶Œì¥ |

---

## ğŸ¯ ê¶Œì¥ ì‚¬í•­

### ì‚¬ìš©ìì—ê²Œ ì•ˆë‚´
```
íŒŒì¼ ì—…ë¡œë“œ ì‹œ:
1. âœ… UTF-8 ì¸ì½”ë”© ê¶Œì¥
2. âœ… ë©”ëª¨ì¥ì—ì„œ "ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì €ì¥" â†’ ì¸ì½”ë”©: UTF-8 ì„ íƒ
3. âš ï¸ í•œê¸€ íŒŒì¼ëª…ë„ ê°€ëŠ¥í•˜ì§€ë§Œ ì˜ë¬¸ ê¶Œì¥
```

### í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìì—ê²Œ
```
1. âœ… í•­ìƒ readAsText() ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì— 'UTF-8' ëª…ì‹œ
2. âœ… file.text() ëŒ€ì‹  FileReader ì‚¬ìš©
3. âœ… API ìš”ì²­ ì‹œ Content-Typeì— charset=utf-8 í¬í•¨
4. âœ… ì‘ë‹µ ì²˜ë¦¬ ì‹œì—ë„ UTF-8 ê°€ì •
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [MDN FileReader](https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsText)
- [UTF-8 Everywhere](http://utf8everywhere.org/)
- [PapaParse Encoding](https://www.papaparse.com/docs#config)

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ë°°í¬ ì „ í™•ì¸:
- [ ] ëª¨ë“  FileReaderì— `UTF-8` ëª…ì‹œ
- [ ] PapaParseì— `encoding: 'UTF-8'` ì„¤ì •
- [ ] API ìš”ì²­ í—¤ë”ì— `charset=utf-8` í¬í•¨
- [ ] í•œê¸€ í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] í•œê¸€ JSON íŒŒì¼ë¡œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] í•œê¸€ CSV íŒŒì¼ë¡œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] í•œê¸€ PDF íŒŒì¼ë¡œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ

---

**ì ìš© ì¼ì**: 2025-10-15  
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ
